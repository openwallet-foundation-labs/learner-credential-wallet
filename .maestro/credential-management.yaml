appId: ${APP_ID}
env:
  PASSWORD: "TestPassword123!"
  CREDENTIAL_JSON: |-
    {
      "@context": [
          "https://www.w3.org/2018/credentials/v1",
          "https://purl.imsglobal.org/spec/ob/v3p0/context-3.0.3.json",
          "https://w3id.org/security/data-integrity/v2",
          "https://w3id.org/security/suites/ed25519-2020/v1"
      ],
      "id": "urn:uuid:2fe53dc9-b2ec-4939-9b2c-0d00f6663b6c",
      "issuanceDate": "2025-01-09T15:06:31Z",
      "type": [
          "VerifiableCredential",
          "OpenBadgeCredential"
      ],
      "name": "DCC Test Credential",
      "issuer": {
          "type": [
              "Profile"
          ],
          "id": "did:key:z6MkuL7x2mTEoBmUuuaQ2hvEUd2YsEtmsHeX9JzqJZ8VYaVH",
          "name": "Digital Credentials Consortium Test Issuer",
          "url": "https://dcconsortium.org",
          "image": "https://user-images.githubusercontent.com/752326/230469660-8f80d264-eccf-4edd-8e50-ea634d407778.png"
      },
      "credentialSubject": {
          "type": [
              "AchievementSubject"
          ],
          "achievement": {
              "id": "urn:uuid:bd6d9316-f7ae-4073-a1e5-2f7f5bd22922",
              "type": [
                  "Achievement"
              ],
              "achievementType": "Diploma",
              "name": "Badge",
              "description": "This is a sample credential issued by the Digital Credentials Consortium to demonstrate the functionality of Verifiable Credentials for wallets and verifiers.",
              "criteria": {
                  "type": "Criteria",
                  "narrative": "This credential was issued to a student that demonstrated proficiency in the Python programming language that occurred from **February 17, 2023** to **June 12, 2023**."
              },
              "image": {
                  "id": "https://user-images.githubusercontent.com/752326/214947713-15826a3a-b5ac-4fba-8d4a-884b60cb7157.png",
                  "type": "Image"
              }
          },
          "name": "Jane Doe"
      },
      "proof": [
          {
              "type": "DataIntegrityProof",
              "created": "2025-05-09T19:02:33Z",
              "verificationMethod": "did:key:z6MkuL7x2mTEoBmUuuaQ2hvEUd2YsEtmsHeX9JzqJZ8VYaVH#z6MkuL7x2mTEoBmUuuaQ2hvEUd2YsEtmsHeX9JzqJZ8VYaVH",
              "cryptosuite": "eddsa-rdfc-2022",
              "proofPurpose": "assertionMethod",
              "proofValue": "z2YEmAhbPqipyhJatMCWibQqEmoE9ViDm6HUU64pub8jmMiyL9VmNL7SDVUZXoBAa6aksG6iLmF7yt14tQXU4VJ6H"
          },
          {
              "type": "Ed25519Signature2020",
              "created": "2025-05-09T19:02:33Z",
              "verificationMethod": "did:key:z6MkuL7x2mTEoBmUuuaQ2hvEUd2YsEtmsHeX9JzqJZ8VYaVH#z6MkuL7x2mTEoBmUuuaQ2hvEUd2YsEtmsHeX9JzqJZ8VYaVH",
              "proofPurpose": "assertionMethod",
              "proofValue": "z22ELGnLk8f1KKH9WA7mkw3X65iEH6d6F413u1DStC7Vc4neZsHTWmiRti54bKz6HRXzqnaRBfApPZctQn7c3Ht2U"
          }
      ]
    }

---
# Reuse the onboarding flow to create a fresh wallet
- runFlow:
    file: onboarding.yaml

# Verify we are on the empty wallet home screen
- extendedWaitUntil:
    visible: "Looks like your wallet is empty."
    timeout: 15000

# Wait for animation to complete  
- waitForAnimationToEnd

# Tap on Add Credential button
- tapOn: "Add Credential"

# Wait for animation to complete
- waitForAnimationToEnd

# Wait for the Add Credential screen to appear
- extendedWaitUntil:
    visible: "Paste JSON or URL"
    timeout: 10000

# Paste JSON or URL - tap on input field and enter credential JSON
- tapOn:
    id: "paste-json-input"
- inputText: "${CREDENTIAL_JSON}"

# Wait a moment for the Add button to become enabled
- waitForAnimationToEnd

# Submit credential
- tapOn:
    id: "add-credential-button"

# Wait for pending credential approval UI
- extendedWaitUntil:
    visible: "Accept"
    timeout: 10000

# Accept the pending credential and return home
- tapOn: "Accept"
- tapOn: "Done"

# Confirm we are back on the Home screen
- extendedWaitUntil:
    visible: "Home Screen"
    timeout: 15000
