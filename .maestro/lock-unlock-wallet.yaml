appId: ${APP_ID}
env:
  PASSWORD: "TestPassword123!"
---

# Setup: Run complete flow
- runFlow:
    file: profile-management.yaml

- tapOn:
    point: "10%,10%"

# Navigate to Settings tab
- tapOn:
    id: "settings-tab"

- waitForAnimationToEnd

# Verify Settings screen loaded
- extendedWaitUntil:
    visible: "Sign out"
    timeout: 5000

# Lock the wallet
- tapOn:
    id: "signout-button"

- waitForAnimationToEnd:
    timeout: 3000

# Verify Login screen appears
- extendedWaitUntil:
    visible: "Unlock Wallet"
    timeout: 5000

# Test incorrect password
- tapOn:
    id: "password-input"

- inputText: "WrongPassword123!"

- tapOn:
    text: "Unlock Wallet"

- waitForAnimationToEnd:
    timeout: 3000

# Enter correct password (field auto-cleared after failed attempt)
- tapOn:
    id: "password-input"

- waitForAnimationToEnd:
    timeout: 2000

- inputText: "${PASSWORD}"

- waitForAnimationToEnd:
    timeout: 2000

- hideKeyboard

- waitForAnimationToEnd:
    timeout: 2000

# Unlock wallet with correct password (try both id and text)
- tapOn:
    text: "Unlock Wallet"

- runFlow:
    when:
      visible: "Unlock Wallet"
    commands:
      - tapOn:
          text: "Unlock Wallet"

- waitForAnimationToEnd:
    timeout: 5000

# Verify wallet unlocked and returned to home screen
- extendedWaitUntil:
    visible: "Home Screen"
    timeout: 10000
